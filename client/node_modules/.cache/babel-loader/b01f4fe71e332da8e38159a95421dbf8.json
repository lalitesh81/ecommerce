{"ast":null,"code":"import { createOrder } from \"./FetchApi\";\nexport const fetchData = async (cartListProduct, dispatch) => {\n  dispatch({\n    type: \"loading\",\n    payload: true\n  });\n\n  try {\n    let responseData = await cartListProduct();\n\n    if (responseData && responseData.Products) {\n      setTimeout(function () {\n        dispatch({\n          type: \"cartProduct\",\n          payload: responseData.Products\n        });\n        dispatch({\n          type: \"loading\",\n          payload: false\n        });\n      }, 1000);\n    }\n  } catch (error) {\n    console.log(error);\n  }\n};\nexport const fetchbrainTree = async (getBrainTreeToken, setState) => {\n  try {\n    let responseData = await getBrainTreeToken();\n\n    if (responseData && responseData) {\n      setState({\n        clientToken: responseData.clientToken,\n        success: responseData.success\n      });\n      console.log(responseData);\n    }\n  } catch (error) {\n    console.log(error);\n  }\n};\nexport const pay = async (data, dispatch, state, setState, totalCost, history) => {\n  console.log(state);\n\n  if (!state.address) {\n    setState({ ...state,\n      error: \"Please provide your address\"\n    });\n  } else if (!state.phone) {\n    setState({ ...state,\n      error: \"Please provide your phone number\"\n    });\n  } else {\n    let orderData = {\n      allProduct: JSON.parse(localStorage.getItem(\"cart\")),\n      user: JSON.parse(localStorage.getItem(\"jwt\")).user._id,\n      amount: totalCost,\n      address: state.address,\n      phone: state.phone\n    };\n    console.log(orderData);\n    alert(\"call\");\n\n    try {\n      let resposeData = await createOrder(orderData);\n\n      if (resposeData.success) {\n        localStorage.setItem(\"cart\", JSON.stringify([]));\n        dispatch({\n          type: \"cartProduct\",\n          payload: null\n        });\n        dispatch({\n          type: \"cartTotalCost\",\n          payload: null\n        });\n        dispatch({\n          type: \"orderSuccess\",\n          payload: true\n        });\n        setState({\n          clientToken: \"\",\n          instance: {}\n        });\n        dispatch({\n          type: \"loading\",\n          payload: false\n        });\n        return history.push(\"/\");\n      } else if (resposeData.error) {\n        console.log(resposeData.error);\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  }\n};","map":{"version":3,"names":["createOrder","fetchData","cartListProduct","dispatch","type","payload","responseData","Products","setTimeout","error","console","log","fetchbrainTree","getBrainTreeToken","setState","clientToken","success","pay","data","state","totalCost","history","address","phone","orderData","allProduct","JSON","parse","localStorage","getItem","user","_id","amount","alert","resposeData","setItem","stringify","instance","push"],"sources":["C:/Users/Lalitesh Nohwar/Desktop/Apni Dukaan/client/src/components/shop/order/Action.js"],"sourcesContent":["import { createOrder } from \"./FetchApi\";\r\n\r\nexport const fetchData = async (cartListProduct, dispatch) => {\r\n  dispatch({ type: \"loading\", payload: true });\r\n  try {\r\n    let responseData = await cartListProduct();\r\n    if (responseData && responseData.Products) {\r\n      setTimeout(function () {\r\n        dispatch({ type: \"cartProduct\", payload: responseData.Products });\r\n        dispatch({ type: \"loading\", payload: false });\r\n      }, 1000);\r\n    }\r\n  } catch (error) {\r\n    console.log(error);\r\n  }\r\n};\r\n\r\nexport const fetchbrainTree = async (getBrainTreeToken, setState) => {\r\n  try {\r\n    let responseData = await getBrainTreeToken();\r\n    if (responseData && responseData) {\r\n      setState({\r\n        clientToken: responseData.clientToken,\r\n        success: responseData.success,\r\n      });\r\n      console.log(responseData);\r\n    }\r\n  } catch (error) {\r\n    console.log(error);\r\n  }\r\n};\r\n\r\nexport const pay = async (\r\n  data,\r\n  dispatch,\r\n  state,\r\n  setState,\r\n  totalCost,\r\n  history\r\n) => {\r\n  console.log(state);\r\n  if (!state.address) {\r\n    setState({ ...state, error: \"Please provide your address\" });\r\n  } else if (!state.phone) {\r\n    setState({ ...state, error: \"Please provide your phone number\" });\r\n  } else {\r\n    let orderData = {\r\n      allProduct: JSON.parse(localStorage.getItem(\"cart\")),\r\n      user: JSON.parse(localStorage.getItem(\"jwt\")).user._id,\r\n      amount: totalCost,\r\n      address: state.address,\r\n      phone: state.phone,\r\n    };\r\n    console.log(orderData);\r\n    alert(\"call\");\r\n    try {\r\n      let resposeData = await createOrder(orderData);\r\n      if (resposeData.success) {\r\n        localStorage.setItem(\"cart\", JSON.stringify([]));\r\n        dispatch({ type: \"cartProduct\", payload: null });\r\n        dispatch({ type: \"cartTotalCost\", payload: null });\r\n        dispatch({ type: \"orderSuccess\", payload: true });\r\n        setState({ clientToken: \"\", instance: {} });\r\n        dispatch({ type: \"loading\", payload: false });\r\n        return history.push(\"/\");\r\n      } else if (resposeData.error) {\r\n        console.log(resposeData.error);\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}